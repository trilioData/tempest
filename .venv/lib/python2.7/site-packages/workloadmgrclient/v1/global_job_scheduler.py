# Copyright (c) 2013 TrilioData, Inc.
"""
Global Job Scheduler Interface (1.1 extension).
"""
from workloadmgrclient import base


class GlobalJobScheduler(base.Resource):
    """A global job scheduler describes the job scheduler setting"""
    def __repr__(self):
        return "<gobal-job-scheduler: %s>" % str(self.enabled)


class GlobalJobSchedulerManager(base.ManagerWithFind):
    """Manage :class:`global-job-scheduler` resources."""
    resource_class = GlobalJobScheduler

    def list(self):
        pass

    def get(self):
        """
           Show status of global job scheduler.
        """
        resp, body = self.api.client.get("/global_job_scheduler")
        return body['global_job_scheduler']

    def enable(self):
        """
           Enable global job scheduler
        """
        resp, body = self.api.client.post("/global_job_scheduler/enable")
        return body['global_job_scheduler']

    def disable(self):
        """
           Disable global job scheduler
        """
        resp, body = self.api.client.post("/global_job_scheduler/disable")
        return body['global_job_scheduler']
